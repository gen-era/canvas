<details class="dropdown"
         x-ref="detailsElement"
         x-data="createSearchComponent('{{ model_name }}-{{ label }}', {% if label == 'sample-search' %}false{% else %}true{% endif %})"
>
  <summary>

    <div class="selected-items" x-show="selectedItems.length > 0 || selectedItem">
      <template x-if="isSingleSelect && selectedItem">
        <span>
          <span class="selected-{{ model_name }}-{{ label }}" x-text="selectedItem"></span>
          <a href="#" @click.prevent.stop="removeItem()">×</a>
        </span>
      </template>
      <template x-if="!isSingleSelect">
        <template x-for="item in selectedItems" :key="item">
          <span class="badge">
            <span class="selected-{{ model_name }}-{{ label }}" x-text="item"></span>
            <a href="#" @click.prevent.stop="removeItem(item)">×</a>
          </span>
        </template>
      </template>
    </div>


    <template x-if="!selectedItem">
    <input
      x-ref="searchInput"
      type="search"
      name="search"
      x-model="searchQuery"
      placeholder="Search {{ model_name|capfirst }}..."
      hx-get="{% url 'generic_search' model_name=model_name field_name=field_name %}"
      hx-trigger="input changed, focus"
      hx-target="next ul"
      hx-swap="innerHTML"
      hx-vals='{"page": 1}'
      @input="openDropdown()"
    />
    </template>
  </summary>



  <!-- Dropdown Results -->
  <ul style="overflow:auto; max-height:24vh;">
    <!-- Search results will be inserted here -->
  </ul>



</details>
